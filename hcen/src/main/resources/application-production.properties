# ==============================================
# HCEN Production Configuration
# ==============================================
# ANTEL mi-nube deployment configuration
# Uses environment variables for sensitive data
#
# IMPORTANT: DO NOT commit secrets to version control
# Set environment variables in ANTEL Virtuozzo dashboard
# or Kubernetes secrets
# ==============================================

# ==========================================
# gub.uy OpenID Connect Configuration (PRODUCTION)
# ==========================================

# OIDC Endpoints (Production Environment)
# Replace with actual production URLs from AGESIC
gubuy.oidc.issuer=${GUBUY_OIDC_ISSUER:https://auth.iduruguay.gub.uy/oidc/v1}
gubuy.oidc.authorization.endpoint=${GUBUY_OIDC_AUTH_ENDPOINT:https://auth.iduruguay.gub.uy/oidc/v1/authorize}
gubuy.oidc.token.endpoint=${GUBUY_OIDC_TOKEN_ENDPOINT:https://auth.iduruguay.gub.uy/oidc/v1/token}
gubuy.oidc.userinfo.endpoint=${GUBUY_OIDC_USERINFO_ENDPOINT:https://auth.iduruguay.gub.uy/oidc/v1/userinfo}
gubuy.oidc.jwks.uri=${GUBUY_OIDC_JWKS_URI:https://auth.iduruguay.gub.uy/oidc/v1/jwks}
gubuy.oidc.endsession.endpoint=${GUBUY_OIDC_ENDSESSION_ENDPOINT:https://auth.iduruguay.gub.uy/oidc/v1/logout}

# OAuth 2.0 Client Credentials (FROM ENVIRONMENT VARIABLES - REQUIRED)
# Request production credentials from AGESIC
# Set in ANTEL Virtuozzo: Environment Variables section
gubuy.oidc.client.mobile.id=${GUBUY_CLIENT_MOBILE_ID}
gubuy.oidc.client.web.patient.id=${GUBUY_CLIENT_WEB_PATIENT_ID}
gubuy.oidc.client.web.patient.secret=${GUBUY_CLIENT_WEB_PATIENT_SECRET}
gubuy.oidc.client.web.admin.id=${GUBUY_CLIENT_WEB_ADMIN_ID}
gubuy.oidc.client.web.admin.secret=${GUBUY_CLIENT_WEB_ADMIN_SECRET}

# OAuth 2.0 Scopes
gubuy.oidc.scopes=${GUBUY_OIDC_SCOPES:openid personal_info document profile}

# Authentication Context Class Reference (ACR) Values
gubuy.oidc.acr.values=${GUBUY_OIDC_ACR_VALUES:urn:iduruguay:nid:2 urn:iduruguay:nid:3}

# ==========================================
# HCEN JWT Configuration (PRODUCTION)
# ==========================================

# JWT Issuer (your HCEN production URL)
jwt.issuer=${JWT_ISSUER:https://hcen.uy}

# JWT Time-to-Live (in seconds)
jwt.access.token.ttl=${JWT_ACCESS_TOKEN_TTL:3600}
jwt.refresh.token.ttl=${JWT_REFRESH_TOKEN_TTL:2592000}

# JWT Signing Algorithm (RS256 recommended for production)
jwt.algorithm=${JWT_ALGORITHM:RS256}

# JWT Secret (for HS256 only - NOT RECOMMENDED for production)
# jwt.secret=${JWT_SECRET}

# JWT Signing Key Path (for RS256 - RECOMMENDED)
# Mount private key file in container at /opt/hcen/keys/jwt-private.pem
jwt.signing.key.path=${JWT_SIGNING_KEY_PATH:/opt/hcen/keys/jwt-private.pem}
jwt.public.key.path=${JWT_PUBLIC_KEY_PATH:/opt/hcen/keys/jwt-public.pem}

# ==========================================
# Redis Configuration (PRODUCTION)
# ==========================================

# Redis connection (ANTEL managed Redis or external service)
redis.host=${REDIS_HOST:redis}
redis.port=${REDIS_PORT:6379}
redis.password=${REDIS_PASSWORD}
redis.database=${REDIS_DATABASE:0}
redis.timeout=${REDIS_TIMEOUT:2000}

# Redis SSL/TLS (enable for production)
redis.ssl.enabled=${REDIS_SSL_ENABLED:true}

# Redis Connection Pool
redis.pool.max.total=${REDIS_POOL_MAX_TOTAL:50}
redis.pool.max.idle=${REDIS_POOL_MAX_IDLE:20}
redis.pool.min.idle=${REDIS_POOL_MIN_IDLE:10}

# Redis Connection Timeout
redis.pool.max.wait.millis=${REDIS_POOL_MAX_WAIT:3000}

# ==========================================
# PostgreSQL Configuration (PRODUCTION)
# ==========================================

# PostgreSQL JDBC URL (ANTEL managed PostgreSQL)
# Set via JDBC_DATABASE_URL in Virtuozzo or K8s secret
postgres.jdbc.url=${JDBC_DATABASE_URL:jdbc:postgresql://postgres:5432/hcen}
postgres.username=${DB_USER:hcen}
postgres.password=${DB_PASSWORD}

# Connection Pool Settings
postgres.pool.min.size=${DB_POOL_MIN_SIZE:5}
postgres.pool.max.size=${DB_POOL_MAX_SIZE:20}
postgres.pool.timeout=${DB_POOL_TIMEOUT:30000}

# ==========================================
# MongoDB Configuration (PRODUCTION)
# ==========================================

# MongoDB Connection (for audit logs)
# Use MongoDB Atlas or ANTEL managed MongoDB
mongodb.uri=${MONGODB_URI:mongodb://mongodb:27017/?authSource=admin}
mongodb.database=${MONGODB_DATABASE:hcen}
mongodb.collection.auth_events=${MONGODB_COLLECTION_AUTH:authentication_events}
mongodb.collection.audit_logs=${MONGODB_COLLECTION_AUDIT:audit_logs}

# MongoDB SSL/TLS
mongodb.ssl.enabled=${MONGODB_SSL_ENABLED:true}

# ==========================================
# PDI (Plataforma de Datos e Integración) Configuration
# ==========================================

# PDI SOAP Endpoint (DNIC Servicio Básico de Información)
# Production endpoint provided by AGESIC
pdi.soap.endpoint=${PDI_SOAP_ENDPOINT:https://pdi.gub.uy/dnic/servicio-basico}

# WS-Security Authentication Credentials
# Obtain from AGESIC for production use
pdi.soap.username=${PDI_SOAP_USERNAME}
pdi.soap.password=${PDI_SOAP_PASSWORD}

# Connection Timeouts (in milliseconds)
pdi.soap.timeout.connect=${PDI_CONNECT_TIMEOUT:5000}
pdi.soap.timeout.read=${PDI_READ_TIMEOUT:30000}

# ==========================================
# HTTPS/SSL Configuration
# ==========================================

# Enable HTTPS (WildFly configuration)
# Certificate mounted at /opt/hcen/keys/ssl/
ssl.enabled=${SSL_ENABLED:true}
ssl.keystore.path=${SSL_KEYSTORE_PATH:/opt/hcen/keys/ssl/keystore.jks}
ssl.keystore.password=${SSL_KEYSTORE_PASSWORD}
ssl.key.password=${SSL_KEY_PASSWORD}

# ==========================================
# Logging Configuration
# ==========================================

# Log level (ERROR, WARN, INFO, DEBUG)
log.level.root=${LOG_LEVEL_ROOT:INFO}
log.level.hcen=${LOG_LEVEL_HCEN:INFO}
log.level.hibernate=${LOG_LEVEL_HIBERNATE:WARN}

# Log output path (mount volume for persistence)
log.path=${LOG_PATH:/opt/hcen/logs}

# ==========================================
# CORS Configuration
# ==========================================

# Allowed origins for CORS (comma-separated)
cors.allowed.origins=${CORS_ALLOWED_ORIGINS:https://hcen.uy,https://www.hcen.uy,https://mobile.hcen.uy}

# ==========================================
# Security Headers
# ==========================================

# Content Security Policy
csp.policy=${CSP_POLICY:default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'}

# ==========================================
# Performance & Scaling
# ==========================================

# Connection pool sizes
http.max.connections=${HTTP_MAX_CONNECTIONS:200}
http.connection.timeout=${HTTP_CONNECTION_TIMEOUT:30000}

# Session timeout (in minutes)
session.timeout=${SESSION_TIMEOUT:30}

# ==========================================
# Monitoring & Health Checks
# ==========================================

# Actuator endpoints
management.endpoints.enabled=${MANAGEMENT_ENDPOINTS_ENABLED:true}
management.health.endpoint=${MANAGEMENT_HEALTH_ENDPOINT:/health}

# Prometheus metrics
metrics.enabled=${METRICS_ENABLED:true}
metrics.export.prometheus.enabled=${METRICS_PROMETHEUS_ENABLED:true}

# ==========================================
# ANTEL mi-nube Specific Configuration
# ==========================================

# Application URL (public-facing)
app.base.url=${APP_BASE_URL:https://hcen.uy}

# Environment name
app.environment=${APP_ENVIRONMENT:production}

# Deployment region
app.region=${APP_REGION:uruguay-east}
